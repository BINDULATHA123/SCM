<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="./dashboardstyles.css">

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js">
<link rel="stylesheet"
	href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">

<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
	integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
	crossorigin="anonymous">
  </script>
<script src="script.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="styles.css"> -->
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
		<div class="container">
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#mynav"
				aria-controls="mynav" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<a class="navbar-brand" href="#">
				<div class="d-flex">
					<div class="d-flex align-items-center logo bg-purple">
						<div class="fab fa-joomla h2 text-white"></div>
					</div>
					<div class="ms-3 d-flex flex-column">
						<div class="h4">SCMExpert</div>

					</div>
				</div>
			</a>
			<div class="collapse navbar-collapse" id="mynav">
				<ul class="navbar-nav ms-auto mb-2 mb-lg-0">

					<li class="nav-item">
						<div style="padding-right: 10px;">
							Hello
							<p th:text="${username}"></p>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container mt-4">
		<div class="row">
			<div class="col-lg-3 my-lg-0 my-md-1">
				<div id="sidebar" class="bg-purple">
					<div class="h4 text-white">Account</div>
					<ul>
						<li class="#"><a href="/"
							class="text-decoration-none d-flex align-items-start">
								<div class="d-flex flex-column">
									<div class="link">Dashboard</div>
									<div class="link-desc"></div>
								</div>
						</a></li>
						<li class="active"><a href="/createshipment"
							class="text-decoration-none d-flex align-items-start">

								<div class="d-flex flex-column">
									<div class="link">Create Shipment</div>

								</div>
						</a></li>

						<li><a href="/stream"
							class="text-decoration-none d-flex align-items-start">

								<div class="d-flex flex-column">
									<div class="link">Device Data Stream</div>

								</div>
						</a></li>
						<li><a href="./login.html" th:href="@{login}"
							class="text-decoration-none d-flex align-items-start">

								<div class="d-flex flex-column">
									<div class="link">Logout</div>

								</div>
						</a></li>


					</ul>
				</div>
			</div>
			<div class="col-lg-9 my-lg-0 ">
				<div id="main-content" class="bg-white border">
					<form id="Createshipmentform">
						<div th:if="${param.success}">

							<div class="alert alert-info">Successfully created</div>

						</div>


						<div class="text-uppercase">Add Shipments</div>
						<div class="order bg-light">
							<div class="row">
								<div class="row mb-4 ">
									<label for="invoiceNumber" class="col-sm-6 col-form-label">Shipment/Invoice
										Number</label>
									<div class="col-sm-5">
										<input type="text" onkeypress="return onlyNumberKey(event)"
											class="form-control" name="invoiceNumber"
											placeholder="Shipment/Invoice Number" required>
										<div id="errorDis" style="color: red"></div>
									</div>
								</div>
								<div class="row mb-3">
									<label for="containerNumber" class="col-sm-6 col-form-label">Container
										Number</label>
									<div class="col-sm-5">

										<input type="text" onkeypress="return onlyNumberKeyC(event)"
											class="form-control" name="containerNumber"
											placeholder="Container Number" required>
										<div id="errorDisC" style="color: red"></div>

									</div>
								</div>
								<div class="row mb-3">
									<label class="col-sm-6 col-form-label"
										for="shipmentDescription">Shipment Description</label>
									<div class="col-sm-5">
										<textarea class="form-control" name="shipmentDescription"
											placeholder="Enter Your Description"
											style="overflow: auto; resize: none" rows="4" cols="20"
											required></textarea>
									</div>
								</div>
								<div class="row mb-3">
									<label for="routeDetail" class="col-sm-6 col-form-label">Route
										Details</label>
									<div class="col-sm-5">
										<select class="form-select" required name="routeDetail">
											<option value="" disabled selected hidden>Select
												Route</option>
											<option value="HYDERABAD-TIRUPATI">HYDERABAD-TIRUPATI</option>
											<option value="BANGALORE-TIRUPATI">BANGALORE-TIRUPATI</option>
											<option value="HYDERABAD-BANGALORE">HYDERABAD-BANGALORE</option>
										</select>
									</div>
								</div>
								<div class="row mb-3">
									<label for="goodsType" class="col-sm-6 col-form-label">Goods
										Type</label>
									<div class="col-sm-5">
										<select class="form-select" name="goodsType" required>
											<option value="" disabled selected hidden>Select
												Goods Type</option>
											<option value="Vegetables">Vegetables</option>
											<option value="Fruits">Fruits</option>
											<option value="Electronics">Electronics</option>
										</select>
									</div>
								</div>
								<div class="row mb-3">
									<label for="device" class="col-sm-6 col-form-label">Device</label>
									<div class="col-sm-5">
										<select class="form-select" name="device" required>
											<option value="" disabled selected hidden>Select
												Device</option>
											<option value="20211122">20211122</option>
											<option value="20211123">20211123</option>
											<option value="20211124">20211124</option>
											<option value="20211124">20211125</option>

										</select>
									</div>
								</div>
								<div class="row mb-3">
									<label for="expectedDeliverydate"
										class="col-sm-6 col-form-label">Expected Delivery Date</label>
									<div
										class=" col-sm-5 md-form md-outline input-with-post-icon datepicker">
										<input placeholder="Expected Delivery Date" type="date"
											name="expectedDeliverydate" class="form-control" required>
									</div>
								</div>

								<div class="row mb-3">
									<label for="poNumber" class="col-sm-6 col-form-label">PO
										Number</label>
									<div class="col-sm-5">
										<input type="text" class="form-control"
											onkeypress="return onlyNumberKeyP(event)" name="poNumber"
											placeholder="PONumber" required>
										<div id="errorDisP" style="color: red"></div>
									</div>
								</div>
								<div class="row mb-3">
									<label for="deliveryNumber" class="col-sm-6 col-form-label">Delivery
										Number</label>
									<div class="col-sm-5">
										<input type="text" class="form-control"
											onkeypress="return onlyNumberKeyD(event)"
											name="deliveryNumber" placeholder="DeliveryNumber" required>
										<div id="errorDisD" style="color: red"></div>

									</div>
								</div>
								<div class="row mb-3">
									<label for="NdcNumber" class="col-sm-6 col-form-label">NDC
										Number</label>
									<div class="col-sm-5">
										<input type="text" class="form-control"
											onkeypress="return onlyNumberKeyN(event)" name="ndcNumber"
											placeholder="NDCNumber" required>
										<div id="errorDisN" style="color: red"></div>

									</div>
								</div>
								<div class="row mb-3">
									<label for="batchId" class="col-sm-6 col-form-label">Batch
										Id</label>
									<div class="col-sm-5">
										<input type="text" class="form-control"
											onkeypress="return onlyNumberKeyB(event)" name="batchId"
											placeholder="BatchId" required>
										<div id="errorDisB" style="color: red"></div>

									</div>
								</div>
								<div class="row mb-3">
									<label for="serialNumber" class="col-sm-6 col-form-label">Serial
										Number of Goods</label>
									<div class="col-sm-5">
										<input type="number" class="form-control" name="serialNumber"
											placeholder="Serial Number of Goods" required>
									</div>
								</div>
								<div class="alert alert-info" id="shipmentSuccess"
									style="display: none;"></div>
								<div class="alert alert-danger" id="shipmentError"
									style="display: none;"></div>

								<div class="row mb-2">
									<div class="col-sm-10 offset-sm-6 mt-2">
										<button type="reset" class="btn btn-danger">Cancel
											Shipments</button>
										<button type="submit" class="btn btn-danger"
											onclick="createshipment()">Create Shipment</button>
									</div>

								</div>
							</div>
						</div>

					</form>
				</div>
			</div>

		</div>

	</div>
</body>
<script>
function createshipment(){
	
	var myHeaders = new Headers();
	myHeaders.append("Content-Type", "application/json");
	
	const thisForm = document.getElementById('Createshipmentform');
    console.log(thisForm,"form data")
	const formData = new FormData(thisForm).entries();
	var raw = JSON.stringify(Object.fromEntries(formData));
console.log(raw);onkeypress="return onlyNumberKey(event)"
	//var raw = JSON.stringify({"shipmentNumber":"123","containerNumber":"123","descripton":"Ok","route":"australia","goods":"Groceries","country":"F34@P5","deliveryDate":"2022-12-21","pONumber":"123","deliveryNumber":"123","nDCNumber":"123","batchId":"123","serialNumberOfGoods":"123"});

	var requestOptions = {
  		method: 'POST',
  	
  		headers: myHeaders,
  		body: raw,
  		redirect: 'follow'
	};	
	
	thisForm.addEventListener('submit', function (e) {
		e.preventDefault();
		fetch("http://localhost:8080/createshipment", requestOptions)
		  .then(response => response.text())
		  .then(result => {
		  		console.log(result)
		  		if(result.includes("Exists")){
		  		
					document.getElementById('shipmentSuccess').style.display = "none";
					document.getElementById('shipmentError').style.display = "block";
					document.getElementById('shipmentError').innerText = result;
					thisForm.reset();
				}	
		  		else{
		  		console.log("saved console");
					document.getElementById('shipmentError').style.display = "none";
					document.getElementById('shipmentSuccess').style.display = "block";
					document.getElementById('shipmentSuccess').innerText = result;
					thisForm.reset();
				}
		  		})
		  .catch(error => console.log('error', error));
	});

}
</script>
<script>

        function onlyNumberKey(evt) {

              

            // Only ASCII character in that range allowed

            var ASCIICode = (evt.which) ? evt.which : evt.keyCode

            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){
				document.getElementById("errorDis").innerText = "It allows Numbers only"
                return false;
			}else{
			document.getElementById("errorDis").innerText = ""
			 return true;
			}		
           

        }
 function onlyNumberKeyC(evt) {

              

            // Only ASCII character in that range allowed

            var ASCIICode = (evt.which) ? evt.which : evt.keyCode

            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){
				document.getElementById("errorDisC").innerText = "It allows Numbers only"
                return false;
			}else{
			document.getElementById("errorDisC").innerText = ""
			 return true;
			}		
           

        }
function onlyNumberKeyP(evt) {

              

            // Only ASCII character in that range allowed

            var ASCIICode = (evt.which) ? evt.which : evt.keyCode

            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){
				document.getElementById("errorDisP").innerText = "It allows Numbers only"
                return false;
			}else{
			document.getElementById("errorDisP").innerText = ""
			 return true;
			}		
           

        }

function onlyNumberKeyD(evt) {

              

            // Only ASCII character in that range allowed

            var ASCIICode = (evt.which) ? evt.which : evt.keyCode

            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){
				document.getElementById("errorDisD").innerText = "It allows Numbers only"
                return false;
			}else{
			document.getElementById("errorDisD").innerText = ""
			 return true;
			}		
           

        }
function onlyNumberKeyN(evt) {

              

            // Only ASCII character in that range allowed

            var ASCIICode = (evt.which) ? evt.which : evt.keyCode

            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){
				document.getElementById("errorDisN").innerText = "It allows Numbers only"
                return false;
			}else{
			document.getElementById("errorDisN").innerText = ""
			 return true;
			}		
           

        }
function onlyNumberKeyB(evt) {

              

            // Only ASCII character in that range allowed

            var ASCIICode = (evt.which) ? evt.which : evt.keyCode

            if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){
				document.getElementById("errorDisB").innerText = "It allows Numbers only"
                return false;
			}else{
			document.getElementById("errorDisB").innerText = ""
			 return true;
			}		
           

        }

    </script>
</html>